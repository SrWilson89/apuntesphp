<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Contrase√±as</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="card">
            <h1>üîê Generador de Contrase√±as</h1>
            
            <form method="POST" action="generate.php" class="form">
                <div class="form-group">
                    <label for="length">Longitud de la contrase√±a:</label>
                    <input type="number" id="length" name="length" min="4" max="128" value="12" required>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="uppercase" checked>
                        <span class="checkmark"></span>
                        Incluir may√∫sculas (A-Z)
                    </label>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="lowercase" checked>
                        <span class="checkmark"></span>
                        Incluir min√∫sculas (a-z)
                    </label>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="numbers" checked>
                        <span class="checkmark"></span>
                        Incluir n√∫meros (0-9)
                    </label>
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="symbols">
                        <span class="checkmark"></span>
                        Incluir s√≠mbolos (!@#$%^&*)
                    </label>
                </div>

                <button type="submit" class="generate-btn">Generar Contrase√±a</button>
            </form>

            <?php if (isset($_GET['password'])): ?>
                <div class="result">
                    <h3>Contrase√±a generada:</h3>
                    <div class="password-output">
                        <input type="text" value="<?php echo htmlspecialchars($_GET['password']); ?>" readonly class="password-field" id="passwordField">
                        <button type="button" onclick="copyToClipboard()" class="copy-btn" id="copyBtn">üìã Copiar</button>
                    </div>
                    <div class="password-info">
                        <p>Longitud: <?php echo strlen($_GET['password']); ?> caracteres</p>
                        <div class="strength-meter">
                            <div class="strength-bar" id="strengthBar"></div>
                        </div>
                        <p class="strength-text" id="strengthText"></p>
                    </div>
                </div>
            <?php endif; ?>

            <?php if (isset($_GET['error'])): ?>
                <div class="error">
                    <p><?php echo htmlspecialchars($_GET['error']); ?></p>
                </div>
            <?php endif; ?>
        </div>
    </div>

    <script>
        // Funci√≥n para copiar al portapapeles
        function copyToClipboard() {
            const passwordField = document.getElementById('passwordField');
            passwordField.select();
            passwordField.setSelectionRange(0, 99999);
            
            try {
                document.execCommand('copy');
                
                const copyBtn = document.getElementById('copyBtn');
                const originalText = copyBtn.innerHTML;
                copyBtn.innerHTML = '‚úÖ Copiado!';
                
                setTimeout(() => {
                    copyBtn.innerHTML = originalText;
                }, 2000);
            } catch (err) {
                console.error('Error al copiar: ', err);
                alert('No se pudo copiar la contrase√±a');
            }
        }

        // Funci√≥n para evaluar la fuerza de la contrase√±a
        function evaluatePasswordStrength(password) {
            let score = 0;
            let feedback = [];

            // Longitud
            if (password.length >= 8) score += 25;
            if (password.length >= 12) score += 25;
            
            // Tipos de caracteres
            if (/[a-z]/.test(password)) score += 10;
            if (/[A-Z]/.test(password)) score += 10;
            if (/[0-9]/.test(password)) score += 15;
            if (/[^A-Za-z0-9]/.test(password)) score += 15;

            // Determinar nivel de seguridad
            let level = '';
            let color = '';
            
            if (score < 30) {
                level = 'D√©bil';
                color = '#ff4757';
            } else if (score < 60) {
                level = 'Regular';
                color = '#ffa502';
            } else if (score < 90) {
                level = 'Fuerte';
                color = '#2ed573';
            } else {
                level = 'Muy Fuerte';
                color = '#1e90ff';
            }

            return { score, level, color };
        }

        // Mostrar medidor de fuerza si existe una contrase√±a
        window.addEventListener('load', function() {
            const passwordField = document.getElementById('passwordField');
            if (passwordField) {
                const password = passwordField.value;
                const strength = evaluatePasswordStrength(password);
                
                const strengthBar = document.getElementById('strengthBar');
                const strengthText = document.getElementById('strengthText');
                
                if (strengthBar && strengthText) {
                    strengthBar.style.width = strength.score + '%';
                    strengthBar.style.backgroundColor = strength.color;
                    strengthText.textContent = 'Seguridad: ' + strength.level;
                    strengthText.style.color = strength.color;
                }
            }
        });

        // Validaci√≥n del formulario antes de enviar
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.querySelector('.form');
            if (form) {
                form.addEventListener('submit', function(e) {
                    const checkboxes = form.querySelectorAll('input[type="checkbox"]');
                    const checked = Array.from(checkboxes).some(cb => cb.checked);
                    
                    if (!checked) {
                        e.preventDefault();
                        alert('Debes seleccionar al menos un tipo de car√°cter.');
                        return false;
                    }
                });
            }
        });

        // Funci√≥n para generar contrase√±a en tiempo real (opcional)
        function generatePreview() {
            const length = document.getElementById('length').value;
            const uppercase = document.querySelector('input[name="uppercase"]').checked;
            const lowercase = document.querySelector('input[name="lowercase"]').checked;
            const numbers = document.querySelector('input[name="numbers"]').checked;
            const symbols = document.querySelector('input[name="symbols"]').checked;
            
            let characters = '';
            if (uppercase) characters += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            if (lowercase) characters += 'abcdefghijklmnopqrstuvwxyz';
            if (numbers) characters += '0123456789';
            if (symbols) characters += '!@#$%^&*()_+-=[]{}|;:,.<>?';
            
            if (characters === '') return;
            
            let password = '';
            for (let i = 0; i < length; i++) {
                password += characters.charAt(Math.floor(Math.random() * characters.length));
            }
            
            return password;
        }
    </script>
</body>
</html>